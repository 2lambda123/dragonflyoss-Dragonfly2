# Dragonfly Daemon Internals

## Hierarchy

```
          ┌──────────────────┬──────────────────────────────────────────┐                                  
          │     PeerHost     │                                          │                                  
          ├──────────────────┘                                          │                                  
          │    ┌─────────────────────┐       ┌─────────────────────┐    │      ┌─────────────────────┐     
 Download │    │   DownloadManager   │       │   PeerTaskManager   │    │      │                     │     
  Request │    ├─────────────────────┤       ├─────────────────────┤    │      │                     │     
──────────┼───▶│      Download       │◀─────▶│  RegisterPeerTask   │◀───┼─────▶│                     │     
──────────┼───▶│      Proxy          │       │  PullPieceTasks     │◀───┼─────▶│      Scheduler      │◀───┐
   Proxy  │    │                     │       │  ├─SendPiecePackage ├──┐ │      │                     │    │
  Request │    │                     │    ┌─▶│  └─ReportPieceState │  │ │      │                     │    │
          │    │                     │  ┌─┼─▶│  PeerTaskGC         │  │ │      │                     │    │
          │    └─────────────────────┘  │ │  └─────────────────────┘  │ │      └─────────────────────┘    │
          │                             │ │                           │ │                                 │
          │                             │ │                           │ │                                 │
          │    ┌─────────────────────┐  │ │  ┌─────────────────────┐  │ │      ┌─────────────────────┐    │
          │    │      GCManager      │  │ │  │     PicecManager    │  │ │      │                     │    │
          │    ├─────────────────────┤  │ │  ├─────────────────────┤  │ │      │                     │    │
          │    │                     ├──┘ └──┤    DownloadPiece    │◀─┘ │      │                     │    │
          │    │      PeerTaskGC     │       │    UploadPiece      │────Pull──▶│       PeerHost      │    │
          │    │      PieceGC        ├──────▶│    ReportPiece      │   Piece   │                     │    │
          │    │      PeerHostGC     │       │    PieceGC          │    │      │                     │    │
          │    │                     │       │                     │    │      │                     │    │
          │    └──────────┬──────────┘       └─────────────────────┘    │      └─────────────────────┘    │
          │               │                                             │                                 │
          │               └─────────────────────────────────────────────┼─────────────────────────────────┘
          │                                                             │                                  
          └─────────────────────────────────────────────────────────────┘                                  
```

## Glossary

## Components
